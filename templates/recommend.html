<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì˜¤ëŠ˜ì˜ ì¶”ì²œ - BodyBuddy</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 40px;
    }

    .container {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 40px;
      margin-top: 60px;
      width: 100%;
  }

    .top-bar {
      position: fixed;
      top: 10px;
      left: 10px;
    }

    .info-btn {
      padding: 8px 16px;
      background: #007BFF;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
    }

    .info-btn:hover {
      background: #0056b3;
    }

    .left-panel {
      flex: 1;
      max-width: 500px;
      min-height: 500px;
  }

    .right-panel {
      flex: 1;
      max-width: 700px;
      min-height: 700px;
    }

    .big-section {
      padding: 20px;
      font-size: 18px;
    }

    .section {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background-color: #fafafa;
      min-height: 500px;
    }

    .section h3 {
      font-size: 22px;
      color: #007BFF; /* íŒŒë€ìƒ‰ í¬ì¸íŠ¸ */
      border-bottom: 2px solid #ddd;
      padding-bottom: 5px;
      margin-bottom: 15px;
  }

    .section ul {
      margin: 0;
      padding-left: 20px;
    }

    .calorie-input {
      margin-top: 15px;
      display: flex;
      gap: 10px;
      align-items: center;
  }

    .calorie-input input {
      padding: 10px;
      border: 2px solid #007BFF;
      border-radius: 6px;
      font-size: 16px;
      width: 150px;
      transition: 0.3s;
    }

    .calorie-input input:focus {
      border-color: #0056b3;
      outline: none;
      box-shadow: 0 0 5px rgba(0,123,255,0.5);
    }

    .calorie-input button {
      padding: 10px 18px;
      background: linear-gradient(135deg, #007BFF, #00C6FF);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }

    .calorie-input button:hover {
      background: linear-gradient(135deg, #0056b3, #0099cc);
    }

    #calorie-message {
    margin-top: 15px;
    padding: 10px;
    border-radius: 6px;
    font-size: 16px;
    text-align: center;
  }

    .back-btn {
      position: fixed;
      bottom: 10px;
      left: 10px;
      width: auto;
      padding: 8px 16px;
      background: #888;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      z-index: 9999;
    }

    .back-btn:hover {
      background: #666;
    }
  </style>
</head>
<body>
  <!-- ìƒë‹¨ ë‚´ ì •ë³´ ë²„íŠ¼ -->
  <div class="top-bar">
    <a href="{{ url_for('userInfo', user_id=user_id) }}">
      <button class="info-btn">ë‚´ ì •ë³´</button>
    </a>
  </div>

  <div class="container">
    <!-- ì™¼ìª½: ì˜¤ëŠ˜ì˜ ì‹ë‹¨ ë“œë¡­ë‹¤ìš´ -->
    <div class="left-panel">
      <div class="section">
        <h3>ì•„ì¹¨ğŸ</h3>
        <select id="breakfast" onchange="updateCalories()">
         <option value="">ì„ íƒ ì•ˆí•¨</option>
          {% for food, cal in foods.items() %}
            <option value="{{ cal }}">{{ food }} ({{ cal }} kcal)</option>
          {% endfor %}
        </select><br><br>

        <h3>ì ì‹¬ğŸ¥—</h3>
        <select id="lunch" onchange="updateCalories()">
          <option value="">ì„ íƒ ì•ˆí•¨</option>
            {% for food, cal in foods.items() %}
              <option value="{{ cal }}">{{ food }} ({{ cal }} kcal)</option>
            {% endfor %}
          </select><br><br>

          <h3>ì €ë…ğŸš</h3>
          <select id="dinner" onchange="updateCalories()">
            <option value="">ì„ íƒ ì•ˆí•¨</option>
            {% for food, cal in foods.items() %}
              <option value="{{ cal }}">{{ food }} ({{ cal }} kcal)</option>
            {% endfor %}
          </select><br><br>

          <h3>ê°„ì‹ğŸª</h3>
          <select id="snack" onchange="updateCalories()">
            <option value="">ì„ íƒ ì•ˆí•¨</option>
            {% for food, cal in foods.items() %}
              <option value="{{ cal }}">{{ food }} ({{ cal }} kcal)</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <!-- ì˜¤ë¥¸ìª½: ê¶Œì¥ ì¹¼ë¡œë¦¬ ìˆ˜ì¹˜ í‘œì‹œ + ì…ë ¥ ë°›ê¸°-->
      <div class="right-panel">
        <div class="section big-section">
          <h3>{{ user_name }}ë‹˜ì˜ í•˜ë£¨ ê¶Œì¥ ì¹¼ë¡œë¦¬ğŸ˜Š</h3>
          <p><strong>{{ recommended_calories }} kcal</strong></p>

          <div class="calorie-input">
            <label for="my_calories">ë‚˜ì˜ ì˜¤ëŠ˜ ì¹¼ë¡œë¦¬:</label>
            <input type="number" id="my_calories" placeholder="ì˜¤ëŠ˜ ì„­ì·¨ ì¹¼ë¡œë¦¬ ì…ë ¥">
            <button onclick="checkCalories()">í™•ì¸</button>
          </div>

          <p id="calorie-message" style="margin-top:10px; font-weight:bold;"></p>

          <div class="progress-section">
            <h3>ì§€ê¸ˆ ì§„í–‰ìƒíƒœëŠ”?</h3>
            <p id="progress-value"
              style="font-size: 32px; font-weight: bold; text-align: center;
              {% if progress >= 81 %} color: green;
              {% elif progress >= 61 %} color: limegreen;
              {% elif progress >= 41 %} color: orange;
              {% elif progress >= 21 %} color: orangered;
              {% else %} color: red; {% endif %}">
              {{ progress }}%
            </p>
          </div>
        </div>
      </div>

      <script>
      function updateCalories() {
        const breakfast = parseInt(document.getElementById("breakfast").value) || 0;
        const lunch = parseInt(document.getElementById("lunch").value) || 0;
        const dinner = parseInt(document.getElementById("dinner").value) || 0;
        const snack = parseInt(document.getElementById("snack").value) || 0;

        const total = breakfast + lunch + dinner + snack;
        const recommended = {{ recommended_calories }};
        const messageEl = document.getElementById("calorie-message");

        messageEl.textContent = "ì˜¤ëŠ˜ ì„ íƒí•œ ìŒì‹ ì¹¼ë¡œë¦¬: " + total + " kcal";

        const diff = total - recommended;
        if (diff > 200) {
          messageEl.textContent += " â†’ ê¶Œì¥ëŸ‰ë³´ë‹¤ ë„ˆë¬´ ë§ì•„ìš”!";
          messageEl.style.color = "red";
        } else if (diff < -200) {
          messageEl.textContent += " â†’ ê¶Œì¥ëŸ‰ë³´ë‹¤ ë„ˆë¬´ ì ì–´ìš”!";
          messageEl.style.color = "orange";
        } else {
          messageEl.textContent += " â†’ ì ì ˆí•©ë‹ˆë‹¤!";
          messageEl.style.color = "green";
        }
      }
      </script>
    
      <script>
      function checkCalories() {
        const myCalories = parseInt(document.getElementById("my_calories").value);
        const recommended = {{ recommended_calories }};
        const messageEl = document.getElementById("calorie-message");

        if (isNaN(myCalories)) {
          messageEl.textContent = "ì¹¼ë¡œë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!";
          messageEl.style.color = "red";
          return;
      }

      const diff = myCalories - recommended;

      if (diff > 200) {
        messageEl.textContent = "í°ì¼ë‚˜! ì˜¤ëŠ˜ì²˜ëŸ¼ ì„­ì·¨í•˜ë©´ ì•ˆë¼!";
        messageEl.style.color = "red";
        messageEl.style.backgroundColor = "#ffe5e5";
      } else if (diff < -200) {
        messageEl.textContent = "ì„­ì·¨í•œ ì¹¼ë¡œë¦¬ê°€ ë„ˆë¬´ ì ì–´.. ë‚´ì¼ì€ ë‹¤ì‹œ ì˜í•´ë³´ì!";
        messageEl.style.color = "orange";
        messageEl.style.backgroundColor = "#fff3cd";
      } else {
        messageEl.textContent = "ì˜í–ˆì–´! ë‚´ì¼ë„ ì˜¤ëŠ˜ì²˜ëŸ¼ë§Œ ê¾¸ì¤€í•˜ê²Œ í•˜ìêµ¬!";
        messageEl.style.color = "green";
        messageEl.style.backgroundColor = "#d4edda";
      }
  }
    </script>
    </div>
  </div>

  <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ -->
  <button class="back-btn" onclick="history.back()">ë’¤ë¡œê°€ê¸°</button>
</body>
</html>
